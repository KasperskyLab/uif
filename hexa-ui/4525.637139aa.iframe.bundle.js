"use strict";(self.webpackChunk_kaspersky_hexa_ui=self.webpackChunk_kaspersky_hexa_ui||[]).push([[4525],{"./src/datepicker/RangePicker.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>RangePicker});var _design_system_tokens__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./design-system/tokens/locales.ts"),_helpers_hocs_WithGlobalStyles__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./helpers/hocs/WithGlobalStyles.tsx"),_helpers_hooks_useTestAttribute__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./helpers/hooks/useTestAttribute.ts"),_helpers_imaskDateOptionsGenerator__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./helpers/imaskDateOptionsGenerator.ts"),_src_action_button__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./src/action-button/ActionButton.tsx"),_src_input_inputCss__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/input/inputCss.ts"),classnames__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),react_imask__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-imask/esm/index.js"),styled_components__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),_kaspersky_hexa_ui_icons_16__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/@kaspersky/hexa-ui-icons/esm/16/Calendar.js"),_ActionIcons__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./src/datepicker/ActionIcons.tsx"),_DatePicker__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/datepicker/DatePicker.tsx"),_helpers__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/datepicker/helpers.tsx"),_pickerCss__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/datepicker/pickerCss.ts"),_Presets__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./src/datepicker/Presets.tsx"),_useThemedPicker__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/datepicker/useThemedPicker.ts");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const maskObject=[],{RangePicker:AntdRangePicker}=_DatePicker__WEBPACK_IMPORTED_MODULE_3__.l,StyledRangePicker=(0,styled_components__WEBPACK_IMPORTED_MODULE_4__.Ay)(AntdRangePicker).withConfig({shouldForwardProp:prop=>!["cssConfig"].includes(prop.toString())}).withConfig({displayName:"RangePicker__StyledRangePicker",componentId:"sc-1jiyfkn-0"})([""," ",""],_src_input_inputCss__WEBPACK_IMPORTED_MODULE_5__.z9,_pickerCss__WEBPACK_IMPORTED_MODULE_6__.Sh),CalendarContainer=styled_components__WEBPACK_IMPORTED_MODULE_4__.Ay.div.withConfig({shouldForwardProp:prop=>!["cssConfig"].includes(prop)}).withConfig({displayName:"RangePicker__CalendarContainer",componentId:"sc-1jiyfkn-1"})(["",""],_pickerCss__WEBPACK_IMPORTED_MODULE_6__.Fg),RangePicker=rawProps=>{const{mode,...mappedProps}=(0,_helpers__WEBPACK_IMPORTED_MODULE_7__.X6)(rawProps),themedProps=(0,_useThemedPicker__WEBPACK_IMPORTED_MODULE_8__.D)(mappedProps),{testAttributes}=(0,_helpers_hooks_useTestAttribute__WEBPACK_IMPORTED_MODULE_9__.a)(themedProps);return react__WEBPACK_IMPORTED_MODULE_1__.createElement(RangePickerView,_extends({},themedProps,{mode,testAttributes}))},defaultValue=[null,null],RangePickerView=(0,_helpers_hocs_WithGlobalStyles__WEBPACK_IMPORTED_MODULE_16__.c)((({disabled,readonly,value=defaultValue,onChange,customKeyDown,onDateValidationChange,validDatePattern,cssConfig,presets,open,onOpenChange,testId,testAttributes,showTime=!1,panelRender,format,placeholder,...rest})=>{const[isOpen,setOpenState]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),[date,setDate]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(value),[isDateValid,setIsDateValid]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)((0,_helpers__WEBPACK_IMPORTED_MODULE_7__.vd)(value)),[isMaskApply,setIsMaskApply]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),[localLocale,setLocaleLocale]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)((0,_helpers__WEBPACK_IMPORTED_MODULE_7__._Q)(showTime)),pickerRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null),calendarRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null),wrapperRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null),localeOptions=(0,_helpers__WEBPACK_IMPORTED_MODULE_7__._Q)(showTime),destroyMask=()=>{null==maskObject||maskObject.forEach((el=>{null==el||el.destroy()})),setIsMaskApply(!1)},prepareDateValueByIMask=date=>{var _maskOptions$parse;return(null==maskOptions||null===(_maskOptions$parse=maskOptions.parse)||void 0===_maskOptions$parse?void 0:_maskOptions$parse.call(maskOptions,date))||""},maskOptions=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((()=>(0,_helpers_imaskDateOptionsGenerator__WEBPACK_IMPORTED_MODULE_10__.ZC)(null!=format?format:localLocale.format)),[localLocale]),onClickHandler=e=>{const calendarElement=calendarRef.current,timeSecondsWrapper=null==calendarElement?void 0:calendarElement.querySelector(".ant-picker-time-panel-column:last-child");if(!calendarElement||!timeSecondsWrapper)return;const pickerElement=wrapperRef.current,isUserTimeSelect=(0,_helpers__WEBPACK_IMPORTED_MODULE_7__.$j)(calendarElement,e.target);let newDates=[null,null];const inputs=(null==pickerElement?void 0:pickerElement.querySelectorAll("input"))||[];(async()=>{await new Promise((resolve=>setTimeout((()=>{var _inputs$,_inputs$2;let startDateInputValue=(null===(_inputs$=inputs[0])||void 0===_inputs$?void 0:_inputs$.value)||"",endDateInputValue=(null===(_inputs$2=inputs[1])||void 0===_inputs$2?void 0:_inputs$2.value)||"";if(!isUserTimeSelect){var _inputs$4;var _inputs$3;if((null==pickerElement?void 0:pickerElement.querySelector(".ant-picker-input-active input"))===inputs[0])startDateInputValue=(null===(_inputs$3=inputs[0])||void 0===_inputs$3?void 0:_inputs$3.value.split(" ")[0])+" 00:00:00";endDateInputValue=(null===(_inputs$4=inputs[1])||void 0===_inputs$4?void 0:_inputs$4.value.split(" ")[0])+" 00:00:00"}newDates=(0,_helpers__WEBPACK_IMPORTED_MODULE_7__.mF)([prepareDateValueByIMask(startDateInputValue),prepareDateValueByIMask(endDateInputValue)]),resolve(newDates)}))))})().then((()=>{destroyMask(),setDate(newDates),(0,_helpers__WEBPACK_IMPORTED_MODULE_7__.P8)(timeSecondsWrapper,e.target,5)&&(inputs[0]===(null==pickerElement?void 0:pickerElement.querySelector(".ant-picker-input-active input"))?inputs[1].focus():setOpenState(!1)),handleOnChange(newDates)}))};(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{setDate(value)}),[value]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{setOpenState(Boolean(open))}),[open]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{localeOptions.locale.lang!==localLocale.locale.lang&&setLocaleLocale(localeOptions)}),[localeOptions]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{onDateValidationChange&&onDateValidationChange(isDateValid)}),[isDateValid]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{setIsMaskApply(!1)}),[maskOptions]);const handleOnChange=newDate=>{null==onChange||onChange(newDate)};return react__WEBPACK_IMPORTED_MODULE_1__.createElement("div",{ref:wrapperRef},react__WEBPACK_IMPORTED_MODULE_1__.createElement(StyledRangePicker,_extends({ref:pickerRef},testAttributes,rest,{locale:localeOptions.locale,cssConfig:cssConfig.inputCssConfig,onKeyDown:e=>{var _currentTarget$parent;const currentTarget=e.currentTarget,currentValue=null==currentTarget?void 0:currentTarget.value,rangeInputs=null==currentTarget||null===(_currentTarget$parent=currentTarget.parentElement)||void 0===_currentTarget$parent||null===(_currentTarget$parent=_currentTarget$parent.parentElement)||void 0===_currentTarget$parent?void 0:_currentTarget$parent.querySelectorAll("input");isMaskApply||([...rangeInputs].forEach(((el,i)=>{maskObject[i]=(0,react_imask__WEBPACK_IMPORTED_MODULE_2__.g5)(el,maskOptions)})),setIsMaskApply(!0)),(0,_helpers__WEBPACK_IMPORTED_MODULE_7__.X4)(e.key)&&2===currentValue.split(_design_system_tokens__WEBPACK_IMPORTED_MODULE_11__.DT).length&&setTimeout((()=>{var _maskOptions$parse2,_date$inputNumber;const inputNumber=[...rangeInputs].indexOf(currentTarget),result=null==maskOptions||null===(_maskOptions$parse2=maskOptions.parse)||void 0===_maskOptions$parse2?void 0:_maskOptions$parse2.call(maskOptions,currentTarget.value);var _date$,_date$2;(Array.isArray(date)&&(date[inputNumber]=result||null),isNaN(Number(null==date||null===(_date$inputNumber=date[inputNumber])||void 0===_date$inputNumber?void 0:_date$inputNumber.getTime())))||setDate([null!==(_date$=null==date?void 0:date[0])&&void 0!==_date$?_date$:null,null!==(_date$2=null==date?void 0:date[1])&&void 0!==_date$2?_date$2:null])}),0),setOpenState(!0),null==customKeyDown||customKeyDown(e)},open:null!=open?open:isOpen,value:date,disabled:disabled||readonly,onOpenChange:value=>{null==onOpenChange||onOpenChange(value),setOpenState(value)},onChange:dates=>{destroyMask(),setDate(dates),handleOnChange(dates),setIsDateValid((0,_helpers__WEBPACK_IMPORTED_MODULE_7__.vd)(dates))},onCalendarChange:value=>{if(null===value)return destroyMask(),setDate([null,null]),void handleOnChange(null);null==onChange||onChange(value),setDate(value),setIsDateValid((0,_helpers__WEBPACK_IMPORTED_MODULE_7__.vd)(value))},renderExtraFooter:presets?()=>react__WEBPACK_IMPORTED_MODULE_1__.createElement(_Presets__WEBPACK_IMPORTED_MODULE_12__.k,{presets,onChange:dates=>{setOpenState(!1),destroyMask(),setDate(dates),handleOnChange(dates)}}):void 0,panelRender:container=>react__WEBPACK_IMPORTED_MODULE_1__.createElement(CalendarContainer,{ref:calendarRef,className:classnames__WEBPACK_IMPORTED_MODULE_0___default()(rest.className,"kl6-datepicker-calendar",{"kl6-datepicker-range-time-calendar":showTime}),"data-testid":`${testId}-range-calendar`,cssConfig:cssConfig.pickerCssConfig,onClick:onClickHandler},panelRender?panelRender(container):container),suffixIcon:null==date||!date.some((date=>null!==date))||disabled||readonly?react__WEBPACK_IMPORTED_MODULE_1__.createElement(_kaspersky_hexa_ui_icons_16__WEBPACK_IMPORTED_MODULE_14__.A,{testId:`${testId}-calendar-icon`}):react__WEBPACK_IMPORTED_MODULE_1__.createElement(_src_action_button__WEBPACK_IMPORTED_MODULE_13__.r,{testId:`${testId}-calendar-clear-icon`,mode:"filled",onClick:event=>{var _wrapperRef$current;destroyMask(),setDate([null,null]),handleOnChange(null),null===(_wrapperRef$current=wrapperRef.current)||void 0===_wrapperRef$current||null===(_wrapperRef$current=_wrapperRef$current.querySelector("input"))||void 0===_wrapperRef$current||_wrapperRef$current.focus(),event.stopPropagation()}}),superNextIcon:react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ActionIcons__WEBPACK_IMPORTED_MODULE_15__.Ie,{testId:`${testId}-calendar-super-next-icon`}),superPrevIcon:react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ActionIcons__WEBPACK_IMPORTED_MODULE_15__.jo,{testId:`${testId}-calendar-super-prev-icon`}),nextIcon:react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ActionIcons__WEBPACK_IMPORTED_MODULE_15__.mR,{testId:`${testId}-calendar-next-icon`}),prevIcon:react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ActionIcons__WEBPACK_IMPORTED_MODULE_15__.$$,{testId:`${testId}-calendar-prev-icon`}),allowClear:!1,placeholder:null!=placeholder?placeholder:[localeOptions.placeholder,localeOptions.placeholder],format:format?(0,_helpers_imaskDateOptionsGenerator__WEBPACK_IMPORTED_MODULE_10__.HK)(format):localeOptions.format,showTime})),react__WEBPACK_IMPORTED_MODULE_1__.createElement(_pickerCss__WEBPACK_IMPORTED_MODULE_6__.XS,{cssConfig:cssConfig.pickerCssConfig}))}));RangePicker.__docgenInfo={description:"",methods:[],displayName:"RangePicker",props:{dropdownClassName:{required:!1,tsType:{name:"string"},description:"CSS class for the dropdown"},value:{required:!1,tsType:{name:"union",raw:"[DateInputValue, DateInputValue] | null",elements:[{name:"tuple",raw:"[DateInputValue, DateInputValue]",elements:[{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}]},{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}]}]},{name:"null"}]},description:"Date value"},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(dates: RangeDateInputValue) => void",signature:{arguments:[{type:{name:"union",raw:"[DateInputValue, DateInputValue] | null",elements:[{name:"tuple",raw:"[DateInputValue, DateInputValue]",elements:[{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}]},{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}]}]},{name:"null"}]},name:"dates"}],return:{name:"void"}}},description:"Handler for date range changes"},disabledDate:{required:!1,tsType:{name:"signature",type:"function",raw:"(currentDate: Date) => boolean",signature:{arguments:[{type:{name:"Date"},name:"currentDate"}],return:{name:"boolean"}}},description:"Function to determine if a date is disabled"},customKeyDown:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: KeyboardEvent<HTMLInputElement>) => void",signature:{arguments:[{type:{name:"KeyboardEvent",elements:[{name:"HTMLInputElement"}],raw:"KeyboardEvent<HTMLInputElement>"},name:"e"}],return:{name:"void"}}},description:"Custom key down handler for input"},validDatePattern:{required:!1,tsType:{name:"RegExp"},description:"Regular expression pattern for valid date"},onDateValuesChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(startDate: string, endDate: string) => void",signature:{arguments:[{type:{name:"string"},name:"startDate"},{type:{name:"string"},name:"endDate"}],return:{name:"void"}}},description:"Handler called when date values change"},onDateValidationChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(isValid: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"isValid"}],return:{name:"void"}}},description:"Handler called when date validation status changes"},disabled:{required:!1,tsType:{name:"boolean"},description:"Is disabled"},readonly:{required:!1,tsType:{name:"boolean"},description:"Is readonly"},validationStatus:{required:!1,tsType:{name:"validationStatuses[number]",raw:"typeof validationStatuses[number]"},description:"Validation status"},presets:{required:!1,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{ title: ReactNode, value: NonNullable<RangePickerProps['value']> }",signature:{properties:[{key:"title",value:{name:"ReactNode",required:!0}},{key:"value",value:{name:"NonNullable",elements:[{name:"intersection['value']",raw:"RangePickerProps['value']"}],raw:"NonNullable<RangePickerProps['value']>",required:!0}}]}}],raw:"Array<{ title: ReactNode, value: NonNullable<RangePickerProps['value']> }>"},description:"Preset date range options"},hasResetButton:{required:!1,tsType:{name:"boolean"},description:"Flag to indicate if reset button should be present"},showTime:{required:!1,tsType:{name:"boolean"},description:"To provide an additional time selection"},format:{required:!1,tsType:{name:"string"},description:"Date format in input"},theme:{required:!1,tsType:{name:"ThemeKey"},description:"Custom theme"},testId:{required:!1,tsType:{name:"string"},description:"Actual identifier for autotesting, whill be passed to HTML attribute data-testid"},klId:{required:!1,tsType:{name:"string"},description:"@deprecated Use 'testId' prop instead. Identifier for backward compatibility in autotesting, whill be passed to HTML attribute kl-id"},componentId:{required:!1,tsType:{name:"string"},description:"@deprecated Use 'testId' prop instead"},dataTestId:{required:!1,tsType:{name:"string"},description:"@deprecated Use 'testId' prop instead"},componentType:{required:!1,tsType:{name:"string"},description:""}}}}}]);