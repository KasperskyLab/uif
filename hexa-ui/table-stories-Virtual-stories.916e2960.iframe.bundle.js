"use strict";(self.webpackChunk_kaspersky_hexa_ui=self.webpackChunk_kaspersky_hexa_ui||[]).push([[8535],{"./.storybook/components/Meta/withMeta.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{C:()=>withMeta});var Link=__webpack_require__("./src/link/Link.tsx"),Space=__webpack_require__("./src/space/Space.tsx"),Typography=__webpack_require__("./src/typography/Typography.tsx"),react=__webpack_require__("./node_modules/react/index.js"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),Grid=__webpack_require__("./src/grid/Grid.tsx"),GridItem=__webpack_require__("./src/grid/GridItem.tsx"),js=__webpack_require__("./node_modules/@kaspersky/hexa-ui-core/esm/colors/js/index.js"),StatusOkOutline=__webpack_require__("./node_modules/@kaspersky/hexa-ui-icons/esm/24/StatusOkOutline.js"),StatusNoThreadOutline=__webpack_require__("./node_modules/@kaspersky/hexa-ui-icons/esm/24/StatusNoThreadOutline.js");const metaDod={designTokens:"Design tokens",useThemedHook:"Theme hook",unitTests:"Unit tests",screenshotTests:"Screenshot tests",migration:"Migration",apiTable:"API",storybook:"Storybook",pixsoView:"Pixso"},MetaDod=({list})=>{const metaDodKeys=(0,react.useMemo)((()=>Object.keys(metaDod)),[]);return react.createElement(Grid.x,{layout:{cols:["repeat(2, 240px)"]}},metaDodKeys.map((key=>react.createElement(GridItem.E,{key},react.createElement(Space.$,{size:8},list[key]?react.createElement(StatusOkOutline.A,{color:js.CE.icon.status.statusgrass.light}):react.createElement(StatusNoThreadOutline.A,{color:js.CE.icon.status.statusneutral.light}),react.createElement(Typography.E,null,metaDod[key]))))))};MetaDod.__docgenInfo={description:"",methods:[],displayName:"MetaDod",props:{list:{required:!0,tsType:{name:"Partial",elements:[{name:"Record",elements:[{name:"union",raw:"keyof typeof metaDod",elements:[{name:"literal",value:"designTokens"},{name:"literal",value:"useThemedHook"},{name:"literal",value:"unitTests"},{name:"literal",value:"screenshotTests"},{name:"literal",value:"migration"},{name:"literal",value:"apiTable"},{name:"literal",value:"storybook"},{name:"literal",value:"pixsoView"}]},{name:"boolean"}],raw:"Record<keyof typeof metaDod, boolean>"}],raw:"Partial<Record<keyof typeof metaDod, boolean>>"},description:""}}};const StyledHeading=(0,styled_components_browser_esm.Ay)(Typography.D).withConfig({displayName:"withMeta__StyledHeading",componentId:"sc-1xyrw4j-0"})(["border:none !important;padding:0 !important;margin:0 !important;"]),StyledLink=(0,styled_components_browser_esm.Ay)(Link.N).withConfig({displayName:"withMeta__StyledLink",componentId:"sc-1xyrw4j-1"})(["height:20px !important;> span{font-family:inherit !important;font-size:inherit !important;}"]);function withMeta(list,Component){return props=>react.createElement(Space.$,{gap:32,direction:"vertical",align:"start"},react.createElement(Space.$,{gap:16,direction:"vertical",align:"start"},react.createElement(StyledHeading,{type:"H2"},null==list?void 0:list.component),((null==list?void 0:list.pixsoView)||(null==list?void 0:list.designLink))&&react.createElement(Space.$,{gap:16},(null==list?void 0:list.pixsoView)&&react.createElement(StyledLink,{href:list.pixsoView,target:"_blank",decoration:"icon",size:"medium"},"Документация в Pixso"),(null==list?void 0:list.designLink)&&react.createElement(StyledLink,{href:list.designLink,target:"_blank",decoration:"icon",size:"medium"},"Компонент в Pixso"))),react.createElement(Space.$,{gap:16,direction:"vertical",align:"start"},react.createElement(Typography.D,{type:"H4"},"Назначение"),react.createElement(Typography.E,null,(null==list?void 0:list.usage)||"-")),react.createElement(Space.$,{gap:16,direction:"vertical",align:"start"},react.createElement(Typography.D,{type:"H4"},"Технические особенности"),react.createElement(Typography.E,null,(null==list?void 0:list.description)||"-")),(null==list?void 0:list.dod)&&react.createElement(MetaDod,{list:list.dod}),Component&&react.createElement(Component,props))}},"./src/table/stories/_commonConstants.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Dn:()=>patchKeys,I7:()=>basicArgTypes,MF:()=>basicDataSource,W4:()=>basicTreeDataSource,YB:()=>columns,ei:()=>columnsWithLegacyEnumCountries,hz:()=>genArgType,iU:()=>BasicTableStory,mO:()=>Wrapper,q0:()=>basicTwoColumns,t$:()=>generateDataSource});var _src_locale__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/locale/Locale.tsx"),_src_table__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/table/index.ts"),_src_table__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/table/modules/Filters/types.ts"),react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const Wrapper=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js").Ay.div.withConfig({displayName:"_commonConstants__Wrapper",componentId:"sc-1v4ur0m-0"})(["width:100%;"]),BasicTableStory=args=>{var _args$rowSelection;const[selectedRowKeys,setSelectedRowKeys]=(0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(null===(_args$rowSelection=args.rowSelection)||void 0===_args$rowSelection?void 0:_args$rowSelection.selectedRowKeys);return react__WEBPACK_IMPORTED_MODULE_3__.createElement(Wrapper,null,react__WEBPACK_IMPORTED_MODULE_3__.createElement(_src_table__WEBPACK_IMPORTED_MODULE_1__.XI,_extends({rowSelection:{selectedRowKeys,onChange:newSelectedRowKeys=>{console.log(`selectedRowKeys changed: ${newSelectedRowKeys}`),setSelectedRowKeys(newSelectedRowKeys)}}},args)))},patchKeys=(data,prefix=[])=>data.map(((item,index)=>({...item,...item.children&&{children:patchKeys(item.children,[...prefix,index])},key:[...prefix,index].join(",")}))),genArgType=(description,control,defaultValue)=>({description,control,table:defaultValue?{defaultValue:{summary:defaultValue}}:void 0}),basicArgTypes={columns:genArgType("An array of column objects"),dataSource:genArgType('An array of data. Each object should contain all field used as a "dataIndex" in "columns"'),rowSelection:genArgType("rowSelection.selectedRowKeys - an array of selected rows<br/>      rowSelection.onChange - controlled handler<br/>      rowSelection.type ('checkbox' | 'radio')","object","{}"),useAccordion:genArgType("Is needed to use accordion in dataSource","boolean","false"),onDragStart:genArgType("Handler for start of dragging"),onDragEnd:genArgType("Handler for end of dragging"),useDragDrop:genArgType("Is drag-n-drop enabled","boolean","false"),emptyText:genArgType("Custom ReactElement that will be shown instead of default empty text"),groupBy:genArgType("dataIndex of column to group"),groupTitleRender:genArgType("Render function for title of group"),rowClassName:genArgType("Classname for each row. It can be used to style content (hover, for example)"),backgroundPattern:{...genArgType("Background pattern that will be visible on rows with _blendedBackground","radio","diagonal"),options:[void 0,"diagonal"]},onColumnResize:genArgType("Handler on column resize"),resizingMode:{...genArgType("Resizing mode","select"),options:["max","last","manual","scroll"]},stickyHeader:genArgType("Intend from top in px. Set undefined if sticky is not needed","number","undefined"),loading:genArgType("Is table loading","boolean","false"),loaderProps:genArgType("loaderProps.indicator - custom loader component<br/>loaderProps.delay - delay to show loader"),pagination:{...genArgType("Go to Hexa UI Components/Pagination. Allowed props: current, pageSize, total, simple, onChange, onShowSizeChange.External fields:<br/>pagination.infiniteScrollPageGetter: (page, pageSize) => Promise- function that returns Promise where you can set new data on resolve() and throw error on reject()")},infiniteScrollEndTableText:genArgType("End text when table is ended during infinite scrolling"),infiniteScrollRetryText:genArgType("Retry text when some error occurred during infinite scrolling"),infiniteScrollErrorText:genArgType("Error text when some error occurred during infinite scrolling"),toolbar:{...genArgType("Go to Hexa UI Components/Toolbar. External fields:<br/>toolbar.showSearch - is search enabled<br/>toolbar.showColumns - is columns selector shown<br/>toolbar.showGrouping - is grouping selector shown")},enableSearchHighlighting:genArgType("Should the found text be highlighted","boolean","false"),filterItems:genArgType("An array of filters to show"),initialFilters:genArgType("Filters to set by default"),initialSorting:genArgType("initialSorting.field - column to sort by default<br/>initialSorting.direction - direction of sorting"),saveFilters:genArgType("saveFilters.storageKey - key name of saved filters"),expandable:genArgType('expandable.expandColumnName = "col1" - expanding the tree will be at col1'),defaultColumnWidth:genArgType("Default width of columns","number","undefined"),columnVerticalAlign:{...genArgType("Column vertical align","radio","top"),options:["top","middle","bottom","inherit"]},rowMode:{...genArgType("Row mode","radio","standard"),options:["standard","compact"]},disabled:genArgType("If rowSelection is disabled","boolean","false")},basicTwoColumns=[{title:"table.column.name",key:"name",dataIndex:"name",width:300},{title:"table.column2.name",key:"description",dataIndex:"description"}],generateDataSource=length=>Array.from({length},((_,index)=>({name:`Value ${index+1}`,description:`Description ${index+1}`,key:index+1,details:{city:`city-${index+1}`,email:"email-"+(length-index)}}))),basicDataSource=generateDataSource(180),basicTreeDataSource=[{name:"John Doe",description:"Nice guy",age:34},{name:"Jane Doe",description:"Cool girl",age:33},{name:"James Doe",description:"Noble man",age:65,children:[{name:"Mary Sue",description:"Dubious character",age:41,children:[{name:"Dirk Gently",description:"Best detective",age:15}]},{name:"John Snow",description:"Knows nothing",age:45}]},{name:"Judy Doe",description:"Great person",age:38}],mockCreateColumn=(name,width,show=!0,hideColumnAvailable=!0)=>({key:name,title:react__WEBPACK_IMPORTED_MODULE_3__.createElement(_src_locale__WEBPACK_IMPORTED_MODULE_0__.h,{localizationKey:`table.columnsSettings.columnTitles.${name}`}),dataIndex:name,width:`${width}%`,show,hideColumnAvailable,groupingAvailable:!0}),countries=[{label:"Russian Federation",value:"Russian Federation"},{label:"China",value:"China"},{label:"Pakistan",value:"Pakistan"},{label:"United States",value:"United States"},{label:"France",value:"France"},{label:"Germany",value:"Germany"},{label:"Italy",value:"Italy"},{label:"Spain",value:"Spain"},{label:"Brazil",value:"Brazil"},{label:"Australia",value:"Australia"}],legacyCountries=["Russian Federation","China","Pakistan","United States","France","Germany","Italy","Spain","Brazil","Australia"],columns=[mockCreateColumn("name",19,!0,!1),{...mockCreateColumn("country",13),filterType:{type:_src_table__WEBPACK_IMPORTED_MODULE_2__.R.Enum,operations:[{operation:_src_table__WEBPACK_IMPORTED_MODULE_2__.e.eq},{operation:_src_table__WEBPACK_IMPORTED_MODULE_2__.e.neq},{operation:_src_table__WEBPACK_IMPORTED_MODULE_2__.e.custom,label:"My custom filter!"}],getAvailableOptions:()=>Promise.resolve(countries)},filters:[{name:"Longer then 5",filter:element=>{const text=element.country;return!!text&&text.length>5}},{name:"Shorter than 5",filter:element=>{const text=element.country;return!!text&&text.length<5}}]},{...mockCreateColumn("age",10),filterType:{type:_src_table__WEBPACK_IMPORTED_MODULE_2__.R.Number},isSortable:!0,allowMultipleFilters:!0,filters:[{name:"Greater than 18",filter:element=>{const age=Number(element.age);return!!age&&age>18}},{name:"Less than 60",filter:element=>{const age=Number(element.age);return!!age&&age<60}}]},{...mockCreateColumn("city",17),isSortable:!0},{...mockCreateColumn("date",18),isSortable:!0,sorter:function(a,b,isAsc){const aDate=new Date(a.date).getTime(),bDate=new Date(b.date).getTime();return isAsc?aDate-bDate:bDate-aDate},filterType:{type:_src_table__WEBPACK_IMPORTED_MODULE_2__.R.DateRange}}],columnsWithLegacyEnumCountries=columns.map((col=>"country"===col.dataIndex?{...col,filterType:{type:_src_table__WEBPACK_IMPORTED_MODULE_2__.R.Enum,getAvailableValues:()=>new Promise((resolve=>{resolve(legacyCountries)}))}}:col));BasicTableStory.__docgenInfo={description:"",methods:[],displayName:"BasicTableStory"}},"./src/table/stories/Virtual.stories.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Basic:()=>Basic,Fetch:()=>Fetch,__namedExportsOrder:()=>__namedExportsOrder,default:()=>Virtual_stories});var withMeta=__webpack_require__("./.storybook/components/Meta/withMeta.tsx"),Button=__webpack_require__("./src/button/Button.tsx"),Link=__webpack_require__("./src/link/Link.tsx"),SectionMessage=__webpack_require__("./src/section-message/SectionMessage.tsx"),Space=__webpack_require__("./src/space/Space.tsx"),Tag=__webpack_require__("./src/tag/Tag.tsx"),Typography=__webpack_require__("./src/typography/Typography.tsx"),react=__webpack_require__("./node_modules/react/index.js"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),table=__webpack_require__("./src/table/index.ts");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}var e_VT_STATE=function(e_VT_STATE){return e_VT_STATE[e_VT_STATE.INIT=1]="INIT",e_VT_STATE[e_VT_STATE.LOADED=2]="LOADED",e_VT_STATE[e_VT_STATE.RUNNING=4]="RUNNING",e_VT_STATE}(e_VT_STATE||{});function log_debug(ctx,msg){if(ctx.debug){if("+"===msg[0])return console.debug(msg.slice(1));const d=new Date,tid=`${d.toLocaleTimeString()}.${d.getMilliseconds()}`;console.debug(`%c[${ctx.id}][${tid}][${msg}]`,"color:#a00",ctx)}}const TableImpl=react.forwardRef((function TableImpl(props,ref){return react.createElement("table",_extends({ref},props))}));function WrapperImpl(props){return react.createElement("tbody",props)}const RowImpl=react.forwardRef((function RowImpl(props,ref){return react.createElement("tr",_extends({ref},props))}));function set_offset(ctx,top,head,tail){ctx._offset_top=0|top,ctx._offset_head=0|head,ctx._offset_tail=0|tail}function scroll_to(ctx,top,left){if(!ctx.wrap_inst.current)return;const ele=ctx.wrap_inst.current.parentElement;ele.scrollTop=top,ele.scrollLeft=Math.max(left,ele.scrollLeft)}function repainting(ctx){if(ctx.HND_PAINT)return;const{cq,wrap_inst}=ctx,fn=()=>{ctx.HND_PAINT=0;for(let i=0;i<cq.length;++i)cq[i].index>=ctx._offset_head&&cq[i].index<ctx._offset_tail&&cq[i].func();if(ctx.vt_state!==e_VT_STATE.RUNNING||!wrap_inst.current)return;const h=ctx.computed_h;if(ctx.WH===h)return;ctx.WH=h;const s=wrap_inst.current.style;s.height=h?(s.maxHeight=h+"px",s.maxHeight):(s.maxHeight="unset",s.maxHeight),ctx.on_update_wrap_style()};ctx.HND_PAINT=8===ctx.evt?window.requestAnimationFrame(fn):window.setTimeout(fn)}function srs_expand(ctx,len,prev_len,fill_value){const slen=len-prev_len,shadow_rows=new Array(slen).fill(fill_value);ctx.row_height=ctx.row_height.concat(shadow_rows),ctx.computed_h+=slen*fill_value}const VTable=(props,ref)=>{const{style,context,...rest}=props,force=(0,react.useState)(0),ref_func=(0,react.useRef)((()=>{}));let scroll_hook;const wrap_inst=(0,react.useMemo)((()=>react.createRef()),[]),ctx=(0,react.useContext)(context);(0,react.useMemo)((()=>{Object.assign(ctx,function default_context(){return{vt_state:e_VT_STATE.INIT,possible_hight_per_tr:-1,computed_h:0,re_computed:0,row_height:[],row_count:0,prev_row_count:0,_offset_top:0,_offset_head:0,_offset_tail:1,WH:0,top:0,left:0,evt:0,end:!1,final_top:0,f_final_top:1,update_count:0,indexMap:new WeakMap,HND_PAINT:0,retry_count:5}}()),ctx.wrap_inst&&ctx.wrap_inst.current&&ctx.wrap_inst.current.parentElement.removeEventListener("scroll",scroll_hook),ctx.wrap_inst=wrap_inst,ctx.top=ctx.initTop,ctx.on_update_wrap_style=()=>{0===ctx._y&&`${ctx._scroll_y}`.length&&scroll_hook({flag:64,target:{scrollTop:ctx.top,scrollLeft:ctx.left}})},ctx.cq=[];let pfirst=0,circleBufferSize=0;ctx.cq.push=item=>{if(ctx.vt_state!==e_VT_STATE.RUNNING)return;const size=ctx._offset_tail-ctx._offset_head+2*ctx.overscanRowCount+10;return circleBufferSize=Math.max(circleBufferSize,size),pfirst>circleBufferSize&&(pfirst=0),ctx.cq[pfirst++]=item,0}}),[]);const event_queue=(0,react.useRef)([]).current;let RAF_update_self;scroll_hook=(0,react.useCallback)((ev=>{if(ctx.vt_state!==e_VT_STATE.RUNNING)return;const t0=performance.now();if(ev){if("flag"in ev)event_queue.push(ev);else{const target=ev.target,top=Math.max(target.scrollTop,0);event_queue.push({target:{scrollTop:top,scrollLeft:target.scrollLeft},end:Math.abs(target.scrollHeight-target.clientHeight-Math.round(top))<=(ctx.offset||0),flag:8})}if(0===ctx.f_final_top)return RAF_update_self(t0)}ctx.HND_RAF||(ctx.HND_RAF=window.setTimeout((()=>Promise.resolve().then((()=>RAF_update_self(t0))))))}),[]),RAF_update_self=(0,react.useCallback)((time=>{ctx.HND_RAF=0;if(performance.now()-time>10&&ctx.retry_count-- >0)return void scroll_hook();if(ctx.retry_count=5,ctx.vt_state!==e_VT_STATE.RUNNING)return;const evq=event_queue;let e;if(!evq.length)return;e=evq.pop(),evq.length=0;let etop=e.target.scrollTop,eleft=e.target.scrollLeft;const flag=e.flag;log_debug(ctx,`top: ${etop}, left: ${eleft}`);const offset=function scroll_with_offset(ctx,top){const{row_height,row_count,overscanRowCount}=ctx;ctx._scroll_y=ctx.scroll.y,"number"==typeof ctx._scroll_y?ctx._y=ctx._scroll_y:("string"==typeof ctx._scroll_y||console.assert(!1,"VT: did you forget to set `scroll.y`?"),ctx._y=ctx.wrap_inst.current.parentElement.offsetHeight),console.assert(ctx._y>=0);let _top=0,i=0,j=0,torender_h=0;if(-1===top&&row_count>0){for(i=row_count;i>0&&torender_h<ctx._y;)torender_h+=row_height[--i];return[0|i,0|row_count,0|ctx.computed_h-torender_h]}for(;i<row_count&&_top<top;++i)_top+=row_height[i];for(j=i;j<row_count&&torender_h<ctx._y;++j)torender_h+=row_height[j];let overscan=overscanRowCount<0?0:overscanRowCount;for(;i>0&&overscan--;)_top-=row_height[--i];return j+=overscanRowCount,j>row_count&&(j=row_count),[0|i,0|j,0|_top]}(ctx,0===ctx.f_final_top?ctx.final_top:etop),head=offset[0],tail=offset[1],top=offset[2],prev_head=ctx._offset_head,prev_tail=ctx._offset_tail,prev_top=ctx._offset_top;let end=!1;switch(flag){case 1:log_debug(ctx,"SCROLLEVT_INIT");break;case 64:log_debug(ctx,"SCROLLEVT_BY_HOOK"),head===prev_head&&tail===prev_tail&&top===prev_top?(ctx.f_final_top=1,-1===ctx.final_top&&(etop=ctx.computed_h-ctx._y),end=!0):-1===ctx.final_top&&(etop=top);break;case 2:if(head===prev_head&&tail===prev_tail&&top===prev_top)return;log_debug(ctx,"SCROLLEVT_RECOMPUTE");break;case 8:if(head===prev_head&&tail===prev_tail&&top===prev_top&&e.end===end)return;log_debug(ctx,"SCROLLEVT_NATIVE"),ctx.onScroll&&ctx.onScroll({top:etop,left:eleft,isEnd:e.end}),end=e.end}set_offset(ctx,top,head,tail),function set_scroll(ctx,top,left,evt,end){ctx.top=top,ctx.left=left,ctx.evt=evt,ctx.end=end}(ctx,etop,eleft,flag,end),force[1](++ctx.update_count)}),[]),(0,react.useImperativeHandle)(ref,(()=>{const scrollTo=y=>{ctx.f_final_top=0,ctx.final_top=y,scroll_hook({target:{scrollTop:y,scrollLeft:-1},flag:64})};return{scrollTo:y=>{ref_func.current=()=>scrollTo(y),ref_func.current()},scrollToIndex:idx=>{ref_func.current=()=>{idx>ctx.row_count-1&&(idx=ctx.row_count-1),idx<0&&(idx=0);let y=0;for(let i=0;i<idx;++i)y+=ctx.row_height[i];scrollTo(y)},ref_func.current()}}}),[]),(0,react.useEffect)((()=>{const el=wrap_inst.current.parentElement;try{el.addEventListener("scroll",scroll_hook,{passive:!0})}catch{el.addEventListener("scroll",scroll_hook,!1)}}),[wrap_inst.current]),(0,react.useEffect)((()=>{scroll_hook({flag:64,target:{scrollLeft:ctx.left,scrollTop:ctx.top}})}),[ctx.scroll.y]),(0,react.useEffect)((()=>{switch(ctx.evt){case 64:0===ctx.f_final_top?ref_func.current():scroll_to(ctx,ctx.top,ctx.left);break;case 1:case 2:scroll_to(ctx,ctx.top,ctx.left)}}),[force[0]]),(0,react.useEffect)((()=>{switch(ctx.vt_state){case e_VT_STATE.LOADED:ctx.vt_state=e_VT_STATE.RUNNING,scroll_hook({target:{scrollTop:ctx.top,scrollLeft:0},flag:64});break;case e_VT_STATE.RUNNING:0!==ctx.re_computed&&(ctx.re_computed=0,scroll_hook({target:{scrollTop:ctx.top,scrollLeft:ctx.left},flag:2}))}}));const wrapStyle=(0,react.useMemo)((()=>({width:style.width,minWidth:"100%",position:"relative",transform:"translate(0)"})),[style.width]),tableStyle=(0,react.useMemo)((()=>({...style,width:void 0,position:"relative",top:ctx._offset_top,transform:"translate(0)"})),[ctx._offset_top]),internalCtx=(0,react.useMemo)((()=>({...ctx})),[ctx.update_count]),Table=ctx.components.table;return react.createElement("div",{ref:wrap_inst,style:wrapStyle},react.createElement(context.Provider,{value:internalCtx},react.createElement(Table,_extends({},rest,{style:tableStyle}))))},VWrapper=props=>{const{children,className,ctx}=props,measureRow=children[0],rows=children[1];let len=Array.isArray(rows)?rows.length:0,{_offset_head:head,_offset_tail:tail}=ctx,trs=[];switch(ctx.vt_state){case e_VT_STATE.INIT:len>=0&&(console.assert(0===head),console.assert(1===tail),Array.isArray(rows)?(trs=rows.slice(head,tail),ctx.indexMap.set(trs[0].props.record,0)):trs=rows,ctx.re_computed=len,ctx.prev_row_count=len,ctx.row_count=len);break;case e_VT_STATE.RUNNING:{if(tail>len){const offset=tail-len;tail-=offset,head-=offset,head<0&&(head=0),tail<0&&(tail=0),set_offset(ctx,ctx._offset_top,head,tail)}ctx.row_count!==len&&function set_tr_cnt(ctx,n){ctx.re_computed=n-ctx.row_count,ctx.prev_row_count=ctx.row_count,ctx.row_count=n}(ctx,len),len=ctx.row_count;const prev_len=ctx.prev_row_count;if(len<prev_len)!function srs_shrink(ctx,len,prev_len){if(0===len)return ctx.computed_h=0,ctx.row_height.length=0,void(ctx.top=0);const rows=ctx.row_height;let h2shrink=0;for(let i=len;i<prev_len;++i)h2shrink+=rows[i];ctx.computed_h-=h2shrink}(ctx,len,prev_len);else if(len>prev_len){const row_h=ctx.row_height;len-row_h.length>0?srs_expand(ctx,len,prev_len,ctx.possible_hight_per_tr):(row_h.fill(ctx.possible_hight_per_tr,prev_len,len),ctx.computed_h+=ctx.possible_hight_per_tr*(len-prev_len))}if(len){let idx=head;trs=rows.slice(idx,tail),trs.forEach((el=>ctx.indexMap.set(el.props.record,idx++)))}else trs=rows;ctx.prev_row_count=ctx.row_count}break;case e_VT_STATE.LOADED:console.assert(!1)}const Wrapper=ctx.components.body.wrapper;return react.createElement(Wrapper,{className},measureRow,trs)},VTRow=props=>{const ref=react.createRef(),{ctx,...rest}=props,children=props.children,Row=ctx.components.body.row;if(!Array.isArray(children))return react.createElement(Row,rest,children);const row_props=children[0].props,index=ctx.indexMap.get(row_props.record),last_index=(0,react.useRef)(index),expanded_cls=(0,react.useMemo)((()=>`.${row_props.prefixCls}-expanded-row`),[row_props.prefixCls]),t0=performance.now();return(0,react.useLayoutEffect)((()=>{const t1=performance.now();return log_debug(ctx,`+idx ${index} tooks ${t1-t0} ms`),ctx.vt_state===e_VT_STATE.RUNNING?repainting(ctx):(ctx.possible_hight_per_tr=ref.current.offsetHeight,srs_expand(ctx,ctx.row_count,0,ctx.possible_hight_per_tr),repainting(ctx),ctx.vt_state=e_VT_STATE.LOADED),()=>{repainting(ctx)}}),[]),(0,react.useEffect)((()=>{ctx.cq.push({index,func:()=>{const rowElm=ref.current;if(!rowElm)return;let h=rowElm.offsetHeight,sibling=rowElm.nextSibling;for(;sibling&&sibling.matches(expanded_cls);)h+=sibling.offsetHeight,sibling=sibling.nextSibling;const curr_h=ctx.row_height[index],last_h=ctx.row_height[last_index.current];ctx.computed_h-=curr_h,ctx.computed_h+=last_h,ctx.computed_h+=h-last_h,ctx.row_height[index]=h}}),repainting(ctx)})),react.createElement(Row,_extends({},rest,{ref}))};function _set_components(ctx,components){const{table,body,header}=components;ctx.components.body={...ctx.components.body,...body},body&&body.cell&&(ctx._vtcomponents.body.cell=body.cell),header&&(ctx.components.header=header,ctx._vtcomponents.header=header),table&&(ctx.components.table=table)}function useVT(fnOpts,deps){const ctx=function init(fnOpts,deps){const ctx=(0,react.useRef)(react.createContext({})).current,ctx_value=(0,react.useContext)(ctx),default_ref=(0,react.useRef)({scrollTo:y=>{},scrollToIndex:idx=>{}});return(0,react.useMemo)((()=>Object.assign(ctx_value,{id:(+new Date).toString(36).slice(4),initTop:0,overscanRowCount:5,debug:!1,ref:default_ref},fnOpts())),deps),(0,react.useMemo)((()=>{const VT=react.forwardRef(VTable);ctx_value._vtcomponents={table:props=>react.createElement(VT,_extends({},props,{context:ctx,ref:ctx_value.ref})),body:{wrapper:props=>react.createElement(ctx.Consumer,null,(()=>react.createElement(VWrapper,_extends({},props,{ctx:ctx_value})))),row:props=>react.createElement(VTRow,_extends({},props,{ctx:ctx_value}))}},ctx_value.components={},_set_components(ctx_value,{table:TableImpl,body:{wrapper:WrapperImpl,row:RowImpl}}),ctx_value.vt_state=e_VT_STATE.INIT}),[]),ctx_value}(fnOpts,deps||[]);return[ctx._vtcomponents,components=>_set_components(ctx,components),ctx.ref]}var meta=__webpack_require__("./src/table/__meta__/meta.json"),_commonConstants=__webpack_require__("./src/table/stories/_commonConstants.tsx");function Virtual_stories_extends(){return Virtual_stories_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Virtual_stories_extends.apply(null,arguments)}const Virtual_stories={title:"Hexa UI Components/Table/Virtual",component:table.XI,args:{useDragDrop:!1},parameters:{docs:{page:(0,withMeta.C)(meta)}},tags:["!autodocs"]},columns=[{..._commonConstants.q0[0],isSortable:!0,width:200},{..._commonConstants.q0[1],isSortable:!0,allowMultipleFilters:!0,filters:[{name:"Even",filter:element=>{const numbers=element.description.match(/\d+/gi);return!!numbers&&Number(numbers[0])%2==0}},{name:"Initial False",filter:()=>!1},{name:"Greater than 20",filter:element=>{const numbers=element.description.match(/\d+/gi);return!!numbers&&Number(numbers[0])>20}}],width:200},{title:"table.column3.name",key:"index",dataIndex:"index",filters:[{name:"Even",filter:element=>Number(element.index)%2==0},{name:"Odd",filter:element=>Number(element.index)%2!=0}],width:200}],data=Array.from({length:200},((_,key)=>({name:`Name-${key}`,index:`Index-${key}`,description:`Description-${key}`,key}))),StyledText=(0,styled_components_browser_esm.Ay)(Typography.E).withConfig({displayName:"Virtualstories__StyledText",componentId:"sc-1s8x5nc-0"})(["display:inline-block;padding-top:8px;"]),StyledTag=(0,styled_components_browser_esm.Ay)(Tag.v).withConfig({displayName:"Virtualstories__StyledTag",componentId:"sc-1s8x5nc-1"})(["margin:0;"]),message=react.createElement(SectionMessage.H,{closable:!1,mode:"info"},react.createElement(Typography.P,null,"@kaspersky/hexa-ui provides ",react.createElement(StyledTag,null,"useVT")," hook for virtualization. It is ",react.createElement(StyledTag,null,"virtualizedtableforantd4")," with few fixes under the hood. For usage details please reference ",react.createElement(Link.N,{href:"https://github.com/wubostc/virtualized-table-for-antd",target:"_blank"},"virtualizedtableforantd4"),".")),Basic={render:args=>{const[selected,setSelected]=(0,react.useState)([]),[vt,,vtRef]=useVT((()=>({scroll:{y:300}})),[]),[dataSource,setDataSource]=(0,react.useState)(data);return react.createElement(_commonConstants.mO,null,message,react.createElement(StyledText,null,"Selected: ",selected.length),react.createElement(Space.$,{gap:8},react.createElement(Button.$,{onClick:()=>vtRef.current.scrollToIndex(0)},"Scroll to Top"),react.createElement(Button.$,{onClick:()=>vtRef.current.scrollTo(-1)},"Scroll to Bottom")),react.createElement(table.XI,Virtual_stories_extends({},args,{dataSource,onDragEnd:setDataSource,columns,components:vt,pagination:!1,rowSelection:{selectedRowKeys:selected,onChange:setSelected},scroll:{y:300}})))}},Fetch={render:args=>{const[selected,setSelected]=(0,react.useState)([]),[dataSource,setDataSource]=(0,react.useState)(data.slice(0,15)),[loading,setLoading]=(0,react.useState)(!1),loadMore=(0,react.useCallback)((async()=>{setLoading(!0),await new Promise((resolve=>setTimeout(resolve,500))),setDataSource(data.slice(0,dataSource.length+15)),setLoading(!1)}),[dataSource.length]),[vt,,vtRef]=useVT((()=>({onScroll:params=>{params.isEnd&&loadMore()},scroll:{y:300}})),[loadMore]);return react.createElement(_commonConstants.mO,null,message,react.createElement(StyledText,null,"Selected: ",selected.length),react.createElement(Space.$,{gap:8},react.createElement(Button.$,{onClick:()=>vtRef.current.scrollToIndex(0)},"Scroll to Top"),react.createElement(Button.$,{onClick:()=>vtRef.current.scrollTo(-1)},"Scroll to Bottom")),react.createElement(table.XI,Virtual_stories_extends({},args,{dataSource,onDragEnd:setDataSource,columns,components:vt,loading,pagination:!1,rowSelection:{selectedRowKeys:selected,onChange:setSelected},scroll:{y:300}})))}},__namedExportsOrder=["Basic","Fetch"];Basic.parameters={...Basic.parameters,docs:{...Basic.parameters?.docs,source:{originalSource:"{\n  render: (args: ITableProps) => {\n    const TABLE_BODY_HEIGHT = 300;\n    const [selected, setSelected] = useState<Key[]>([]);\n    const [vt,, vtRef] = useVT(() => ({\n      scroll: {\n        y: TABLE_BODY_HEIGHT\n      }\n    }), []);\n    const [dataSource, setDataSource] = useState<TableRecord[]>(data);\n    return <Wrapper>\n      {message}\n      <StyledText>Selected: {selected.length}</StyledText>\n      <Space gap={8}>\n        <Button onClick={() => vtRef.current.scrollToIndex(0)}>Scroll to Top</Button>\n        <Button onClick={() => vtRef.current.scrollTo(-1)}>Scroll to Bottom</Button>\n      </Space>\n      <Table {...args} dataSource={dataSource} onDragEnd={setDataSource} columns={columns} components={vt} pagination={false} rowSelection={{\n        selectedRowKeys: selected,\n        onChange: setSelected\n      }} scroll={{\n        y: TABLE_BODY_HEIGHT\n      }} />\n    </Wrapper>;\n  }\n}",...Basic.parameters?.docs?.source}}},Fetch.parameters={...Fetch.parameters,docs:{...Fetch.parameters?.docs,source:{originalSource:"{\n  render: (args: ITableProps) => {\n    const TABLE_BODY_HEIGHT = 300;\n    const [selected, setSelected] = useState<Key[]>([]);\n    const [dataSource, setDataSource] = useState<TableRecord[]>(data.slice(0, 15));\n    const [loading, setLoading] = useState(false);\n    const loadMore = useCallback(async () => {\n      setLoading(true);\n      await new Promise(resolve => setTimeout(resolve, 500));\n      setDataSource(data.slice(0, dataSource.length + 15));\n      setLoading(false);\n    }, [dataSource.length]);\n    const [vt,, vtRef] = useVT(() => ({\n      onScroll: params => {\n        if (params.isEnd) {\n          loadMore();\n        }\n      },\n      scroll: {\n        y: TABLE_BODY_HEIGHT\n      }\n    }), [loadMore]);\n    return <Wrapper>\n      {message}\n      <StyledText>Selected: {selected.length}</StyledText>\n      <Space gap={8}>\n        <Button onClick={() => vtRef.current.scrollToIndex(0)}>Scroll to Top</Button>\n        <Button onClick={() => vtRef.current.scrollTo(-1)}>Scroll to Bottom</Button>\n      </Space>\n      <Table {...args} dataSource={dataSource} onDragEnd={setDataSource} columns={columns} components={vt} loading={loading} pagination={false} rowSelection={{\n        selectedRowKeys: selected,\n        onChange: setSelected\n      }} scroll={{\n        y: TABLE_BODY_HEIGHT\n      }} />\n    </Wrapper>;\n  }\n}",...Fetch.parameters?.docs?.source}}}},"./src/table/__meta__/meta.json"(module){module.exports=JSON.parse('{"dod":{"designTokens":false,"useThemedHook":false,"unitTests":false,"screenshotTests":false,"migration":false,"apiTable":false,"storybook":true},"component":"Table","description":"Компонент-контейнер для группы команд или элементов управления. ","usage":"","designLink":"https://pixso.net/app/design/_JQDYkYJW0yUZVsKeoSybw?icon_type=1&page-id=544%3A2994","pixsoView":"https://pixso.net/app/design/HFxl6PkkfY7YF5YPecc03g"}')}}]);